:: StoryTitle
æ‰˜æ‰˜é‡Œä¹‹å£¶


:: StoryData
{
  "ifid": "BA16F8EA-42F7-407F-A5EC-1FF4DA8BFD8D",
  "format": "SugarCube",
  "format-version": "2.37.3",
  "start": "åˆå§‹ä¹‹åœ°",
  "zoom": 1
}


:: StoryCaption {"position":"825,250","size":"100,100"}
è¡€é‡: $me.hp / $me.max_hp
æ­¦å™¨: $me.weapon.name
é˜²å…·: $me.armor.name
æ”»å‡»åŠ›: $me.weapon.power
é˜²å¾¡: $me.armor.resistance

[[ç‰©å“æ ]]
[[ç§°å·æ ]]


:: ä¸€æœ¬ç¿»å¼€çš„ä¹¦ {"position":"525,250","size":"100,100"}
ä»”ç»†ä¸€çœ‹ï¼Œè¿™ä¸æ˜¯ä¸€æœ¬ä¹¦ï¼Œè€Œæ˜¯è‡ªå·±å†™ä¸‹çš„ç¬”è®°ã€‚

æœ€ä¸Šé¢çš„ä¸€é¡µå†™ç€ï¼š

æ˜å¤©å°±æ˜¯æˆ‘çš„åå…­å²ç”Ÿæ—¥äº†ã€‚
ä»æ˜å¤©å¼€å§‹ï¼Œæˆ‘å°±è¦ç¦»å¼€è¿™ä¸ªå®¶ï¼Œè¸ä¸Šç‹¬è‡ªä¸€äººçš„æ—…ç¨‹ã€‚
æˆ‘æ²¡æœ‰è¿‡å»çš„è®°å¿†ã€‚
è€å¤´ä¹Ÿä¸å‘æˆ‘é€éœ²ä»»ä½•ä¸œè¥¿ã€‚
ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé˜´è°‹ï¼Œä½†æ˜¯ç°åœ¨çš„æˆ‘ä¸å¾—è€ŒçŸ¥ã€‚
å¸Œæœ›æ–°çš„æ—…ç¨‹èƒ½å¤Ÿç»™æˆ‘ç­”æ¡ˆâ€¦â€¦

[[è¿”å›->èµ·å±…å®¤]]


:: ä¸‹ä¸€é¡µ {"position":"850,575","size":"100,100"}
ğŸ–•

æˆ‘è¿˜æƒ³ä½ æ¥å‘Šè¯‰æˆ‘æˆ‘çš„èº«ä¸–å‘¢ï¼Œä½ è¿™ä¸ªBYDä¸å­ç©æ„ã€‚

[[è€å¤´çš„æˆ¿é—´]]

<<script>>
State.variables.oldManLetterRead = true
<</script>>


:: äº¤å‡º5ä¸ªå²è±å§†ç²˜æ¶² {"position":"425,375","size":"100,100"}
<<script>>
let itemName =  'å²è±å§†ç²˜æ¶²'
reduceItemCount(State.variables.inventory.items, itemName, 5)
State.variables.temp = getItem(State.variables.inventory.items, itemName)
addItem(State.variables.inventory.items, State.variables.clownMask, 1)
<</script>>
æŠŠ5ä¸ªå²è±å§†ç²˜æ¶²ç»™äº†è€å¤´ï¼Œç°åœ¨åªå‰©ä¸‹$temp.countä¸ªäº†ã€‚
ä¸è¿‡ä¹Ÿæ²¡ä»€ä¹ˆå¥½å¯æƒœçš„ã€‚

ä½œä¸ºå›æŠ¥ï¼Œè€å¤´ç»™äº†ä½ ä¸€ä¸ªå°ä¸‘é¢å…·ã€‚

[[è¿”å›->å‘è€å¤´æ­è¯]]


:: ä¼‘æ¯ {"position":"525,125","size":"100,100"}
ç»è¿‡å‰§çƒˆçš„ä¼‘æ¯ï¼Œä½“åŠ›æ¢å¤äº†ï¼
<<set $me.hp to $me.max_hp>>\

<<return "è¿”å›">>


:: ä½çŸ®æ—åœ° {"position":"575,525","size":"100,100"}
=ä½çŸ®æ—åœ°=
<<set $slime.hp to $slime.max_hp>>\

å±‹å­æ—è¾¹çš„å°æ ‘æ—ã€‚
è¿™é‡Œç”Ÿæ´»ç€å¾ˆå¤šå¼±å°çš„é­”ç‰©ã€‚
ç›®åŠ›æ‰€åŠçš„åœ°æ–¹å°±æœ‰å¾ˆå¤šå²è±å§†ã€‚\
<<button "æ”»å‡»å²è±å§†" "æˆ˜æ–—ç”»é¢">>
	<<set $lastPassage to 'ä½çŸ®æ—åœ°'>>\
    <<set $enemyVarName to 'slime'>>\
<</button>>\


[[å›å®¶->å¤§å…]]


:: åˆå§‹ä¹‹åœ° {"position":"700,100","size":"100,100"}
æˆ‘çš„åå­—å«ä½œï¼š
<<textbox "$myname" "åå®«ç‹">>

[[è¿›å…¥æ¸¸æˆ->èµ·å±…å®¤]]

<<set $myname to 'åå®«ç‹'>>
<<set $registered to false>>
<<set $said_hello_to_kagei to false>>
<<set $date to 1001>>
<<set $name_of_boy to 'æ‰“å·¥æˆ˜å£«'>>
<<set $said_goodbye_to_boy to false>>

<<set $default_weapon to {name: 'ç©ºæ‰‹', power: 1}>>
<<set $default_armor to {name: 'è¿åŠ¨æœ', resistance: 1}>>
<<set $me to {name: $myname, hp: 100, max_hp: 100, weapon: $default_weapon, armor: $default_armor}>>

<<set $beginnerWeaponGot to false>>
<<set $beginnerWeapon to {name: 'æœ¨å‰‘', power: 4}>>
<<set $beginnerArmor to {name: 'é¹¿çš®å¤¹å…‹', resistance: 3}>>
<<set $inventory to {desc: 'ç‰©å“æ ', items: []}>>
<<set $titles to {desc: 'ç§°å·', items: []}>>


/* NPC & Monsters */
<<script>>
State.variables.slimeDrop =  {name: 'å²è±å§†ç²˜æ¶²', desc: 'å²è±å§†æ‰è½çš„ç²˜ç¨ æ¶²ä½“ï¼Œåº”è¯¥ä¸ä¼šæœ‰äººéœ€è¦å§ï¼Ÿ'};
State.variables.oldMan = {name: 'è€å¤´', max_hp: 100, hp: 100, power: 5, resistance: 2};
State.variables.slime = {
	name: 'å²è±å§†', 
    max_hp: 10,
    hp: 10, 
    power: 1, 
    resistance: 1, 
    drops: [{
    	item: State.variables.slimeDrop, 
        chance: 0.6
    }]
}
State.variables.clownMask = {
	name: 'å°ä¸‘é¢å…·',  desc: 'çœ‹èµ·æ¥æœ‰äº›è¯¡å¼‚çš„é¢å…·ï¼Œèƒ½å¤Ÿå“å“­å°å­©ã€‚'
}
State.variables.oldManSlayer = {
	name: 'å¼‘äº²è€…',  desc: 'åªæ˜¯æ€æ­»äº†ä¸ªè€å¤´è€Œå·²ï¼Œæœ‰ä»€ä¹ˆå¥½å¤§æƒŠå°æ€ªçš„ã€‚'
}
State.variables.slimeSlayer = {
	name: 'å²è±å§†æ€æ‰‹',  desc: 'æœ€å¥½ä¸è¦è®©åŠ¨ç‰©ä¿æŠ¤åä¼šçŸ¥é“ã€‚'
}
<</script>>

<<script>>
    window.dd = State.variables
<</script>>


:: å‘è€å¤´æ­è¯ {"position":"550,375","size":"100,100"}
è€å¤´ï¼šä»Šå¤©æ˜¯ä½ çš„åå…­å²ç”Ÿæ—¥ã€‚ä»ä»Šå¤©å¼€å§‹ï¼Œ$me.nameï¼Œä½ å°†è¦å¼€å§‹ç‹¬è‡ªçš„å†’é™©ç”Ÿæ´»ã€‚

è€å¤´ï¼šç°åœ¨ï¼Œæˆ‘æœ‰ä¸€ä¸ªä»»åŠ¡äº¤ç»™ä½ ï¼Œå»<span class='important'>æ€æ­»5åªå²è±å§†ï¼Œå¸¦å›å®ƒä»¬æ‰è½çš„ç²˜æ¶²</span>ï¼Œå‘æˆ‘è¯æ˜ä½ çš„èƒ½åŠ›ã€‚

è€å¤´ï¼šå²è±å§†ç»å¸¸åœ¨å±‹å¤–çš„<span class='important'>ä½çŸ®æ—åœ°</span>å‡ºæ²¡ã€‚

<<script>>
let hasSlimeDrop = checkHavingItem(State.variables.inventory.items, 'å²è±å§†ç²˜æ¶²')
State.variables.hasSlimeDrop = hasSlimeDrop
if(hasSlimeDrop){
	State.variables.temp = getItem(State.variables.inventory.items, 'å²è±å§†ç²˜æ¶²')
}
<</script>>

<<if $hasSlimeDrop>>
è€å¤´ï¼š ä½ ç°åœ¨æ‹¥æœ‰$temp.countä¸ªå²è±å§†ç²˜æ¶²ã€‚
	<<if $temp.count >= 5>>
    	[[äº¤å‡º5ä¸ªå²è±å§†ç²˜æ¶²]]
	<</if>>
<<else>>
è€å¤´ï¼š ä½ è¿˜æ²¡æœ‰æ‹¿åˆ°å²è±å§†ç²˜æ¶²ã€‚
<</if>>

[[è¿”å›->å¤§å…]]


:: å¤§å… {"position":"700,375","size":"100,100"}
=å¤§å…=

è€æ—§æœ¨å¤´æˆ¿å­çš„å®¢å…ã€‚
ä»è¿™é‡Œå¯ä»¥å‰å¾€[[å°å±‹å‰åå­—è·¯å£]]ï¼Œ[[èµ·å±…å®¤]]å’Œ[[è€å¤´çš„æˆ¿é—´]]ã€‚

<<if $oldMan.hp > 0>>
å®¢å…ä¸­å¤®ç«™ç€ä¸€ä¸ª$oldMan.nameã€‚\
<<button "æ”»å‡»" "æˆ˜æ–—ç”»é¢">>
	<<set $lastPassage to 'å¤§å…'>>\
    <<set $enemyVarName to 'oldMan'>>
<</button>>
[[å‘è€å¤´æ­è¯]]
<<else>>
å®¢å…ä¸­å¤®èººç€$oldMan.nameçš„å°¸ä½“ã€‚
<</if>>


:: å°å±‹å‰åå­—è·¯å£ {"position":"725,525","size":"100,100"}
=å°å±‹å‰åå­—è·¯å£=

ä»è¿™é‡Œå¯ä»¥çœ‹è§ç ´çƒ‚çš„[[å°å±‹->å¤§å…]]ï¼Œå’Œå°å±‹èƒŒåçš„[[ä½çŸ®æ—åœ°]]ã€‚

å¤§é©¬è·¯å¦‚æ­¤ç¬”ç›´ï¼Œè®©äººä¸ç¦æƒ³è±¡å®ƒä¸€å®šå¯ä»¥é€šå¾€æˆ‘æ„æ„¿å‰å¾€çš„ä»»ä½•åœ°æ–¹ã€‚

<<if $oldMan.hp > 0>>
å¯æ˜¯ï¼Œå°±è¿™æ ·ç¦»å¼€è¿™é‡ŒçœŸçš„å¥½å—ï¼Ÿ
<span class='red'>æ€»æ„Ÿè§‰æœ‰äº›ä¸œè¥¿ä»¤äººéš¾ä»¥é‡Šæ€€</span>ã€‚
<<else>>
æ˜¯æ—¶å€™ç¦»å¼€è¿™é‡Œäº†ã€‚
ä»è¿™é‡Œå¯ä»¥å‰å¾€[[ç‹éƒ½]]ã€‚
<</if>>


:: æˆ˜æ–—ç”»é¢ {"position":"1000,225","size":"100,100"}
=æˆ˜æ–—=
<<silently>>\
<<script>>
if (State.variables[State.variables.enemyVarName].hp < 1){
	console.log('Should not fight against dead body');
    State.variables.error = true;
}else{
State.variables.error = 0;
State.variables.me.power = State.variables.me.weapon.power;
State.variables.me.resistance = State.variables.me.armor.resistance;
console.log(State.variables.enemyVarName);
console.log(State.variables[State.variables.enemyVarName]);
console.log(State.variables.me);
let {obj1, obj2} = fight(State.variables.me, State.variables[State.variables.enemyVarName]);
console.log(obj1)
console.log(obj2)
State.variables.me = obj1;
State.variables[State.variables.enemyVarName] = obj2;
State.variables.enemy = obj2; 
}
<</script>>
<</silently>>

<<if $error>>\
	$enemy.nameå·²ç»æ­»äº†ï¼Œè¯·ä¸è¦åå¤é­å°¸ï¼
<<else>>\
å‘$enemy.nameå‘èµ·äº†æ”»å‡»ï¼
<<if $me.hp < 1>>\
<<goto "æ­»äº¡">>\
<<else>>\
<span class='good'>$enemy.nameè¢«ä½ æ€æ­»äº†ï¼</span>
<<include 'ç‰©å“æ‰è½'>>
<<include 'æ€æ­»æ€ªç‰©å›è°ƒ'>>
<</if>>\
<</if>>\

<<link "è¿”å›" $lastPassage>><</link>>


:: æ€æ­»æ€ªç‰©å›è°ƒ {"position":"1250,425","size":"100,100"}
<<silently>>\
<<script>>
if (State.variables.enemy.name == 'å²è±å§†'){
	console.log('æ€æ­»å²è±å§†')
	addItem(State.variables.titles.items, State.variables.slimeSlayer, 1)
}else if (State.variables.enemy.name == 'è€å¤´'){
	console.log('æ€æ­»è€å¤´')
	if (!checkHavingItem(State.variables.titles.items, 'å¼‘äº²è€…')){
    	addItem(State.variables.titles.items, State.variables.oldManSlayer)
    }
}
<</script>>
<</silently>>\


:: æ­»äº¡ {"position":"1125,250","size":"100,100"}
=æ­»äº¡=

<span class='danger'>ä½ è¢«$enemy.nameæ€æ­»äº†ï¼</span>
$enemy.nameçš„HPå‰©ä½™$enemy.hpç‚¹ï¼Œä¸‹æ¬¡å†åŠªåŠ›å§ã€‚

ç‚¹å‡»ä¾§è¾¹æ çš„"RESTART"é‡æ–°å¼€å§‹æ¸¸æˆã€‚


:: ç‰©å“æ‰è½ {"position":"1125,375","size":"100,100"}
<<silently>>\
<<script>>
State.variables.temp = 'è«åå¥‡å¦™çš„å­—ç¬¦ä¸²';
State.variables.temp2 = [];
let enemy = State.variables.enemy;
if ('drops' in enemy){
	let items = dropItems(enemy.drops)
    console.log(items)
    let text = dropString(items)
    State.variables.temp = text
    State.variables.temp2 = items
    if (items.length > 0){
    	addToInventory(State.variables.inventory.items, items)
    }
}else {
    console.log('no drops')
    State.variables.temp = []
}
<</script>>
<</silently>>
<<if $temp2.length > 0>>\
	<span class='good'>$enemy.nameæ‰è½äº†$tempã€‚</span>
<</if>>\


:: ç‰©å“æ  {"position":"875,100","size":"100,100"}
<<for $i, $item range  $inventory.items>>
	<<if $item.count > 0>>
    	åç§°: $item.name x $item.count
        $item.desc
    <</if>>
<</for>>

<<return "è¿”å›">>


:: ç‹å›½æ—…è¡ŒæŒ‡å— {"position":"1000,400","size":"100,100"}
ç¿»å¼€ä¸€çœ‹ï¼Œé‡Œé¢çš„ä¹¦é¡µå…¨éƒ½è¢«æ’•æ‰äº†ï¼Œåªå‰©ä¸‹ä¸€å¼ çº¸ï¼Œä¸Šé¢ç”¨æ½¦è‰çš„å­—ä½“å†™ç€ï¼š

<blockquote>
åœ¨å¤§æ´ªæ°´æ¥ä¸´ä¹‹å‰ï¼Œç¦»å¼€è¿™é‡Œ
<small>PS: æˆ‘æŠŠä¹¦å…¨éƒ½æ’•äº†ï¼Œå› ä¸ºä½ æ˜¯è‡ªç”±çš„</small>
</blockquote>

[[è€å¤´çš„æˆ¿é—´]]


:: ç‹éƒ½ {"position":"725,650","size":"100,100"}
ç¬¬äºŒç« â€¦â€¦
æ–½å·¥ä¸­â€¦â€¦


:: ç§°å·æ  {"position":"1000,100","size":"100,100"}
<<for $i, $item range  $titles.items>>
	<<if $item.count > 0>>
    	ã€Š$item.nameã€‹<<if $item.count > 1>>x $item.count<</if>>
        $item.desc
    <</if>>
<</for>>

<<return "è¿”å›">>


:: è€å¤´çš„ä¿¡ {"position":"1000,550","size":"100,100"}
ä½ çœ‹åˆ°è¿™å°ä¿¡çš„æ—¶å€™ï¼Œæˆ‘å¤§æ¦‚å·²ç»æ­»äº†å§ã€‚
ä½ è‚¯å®šä»¥ä¸ºè¿™è€å¤´æˆ¿é—´é‡Œè—ç€ä¸å¾—äº†çš„ä¸œè¥¿ï¼Œ
ç»“æœåªå‘ç°äº†è¿™å°ä¿¡ã€‚

ä¸€å®šå¾ˆå¤±æœ›å§ã€‚
å¦‚æœæ˜¯æˆ‘çš„è¯ä¸€å®šä¼šå¾ˆå¤±æœ›ã€‚

ä¸è¿‡ä½ è‚¯å®šä¼šæƒ³ï¼šâ€œè¿™å°ä¿¡ä¸€å®šè—ç€å…³äºæˆ‘çš„èº«ä¸–çš„ä¸å¾—äº†çš„ç§˜å¯†â€ã€‚

æ˜¯çš„ï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ ä¸€åˆ‡çœŸç›¸ã€‚

[[ä¸‹ä¸€é¡µ]]


:: è€å¤´çš„æˆ¿é—´ {"position":"850,425","size":"100,100"}
=è€å¤´çš„æˆ¿é—´=

<<if $oldMan.hp > 0>>
è€å¤´ï¼š ç«™ä½ã€‚è°å…è®¸ä½ éšä¾¿è¿›æˆ‘çš„æˆ¿é—´äº†ï¼Ÿ
<<else>>
ç…é£æ™¯çš„æˆ¿é—´ã€‚
å®¶å…·å’Œæˆ‘è‡ªå·±çš„èµ·å±…å®¤å·®ä¸å¤šï¼Œä¸€å¼ åºŠï¼Œä¸€å¼ æ¡Œå­è€Œå·²ã€‚
æ¡Œå­ä¸Šæ‘†ç€[[ä¸€å°ä¿¡->è€å¤´çš„ä¿¡]]ï¼Œå’Œä¸€æœ¬ã€Š[[ç‹å›½æ—…è¡ŒæŒ‡å—]]ã€‹ã€‚

<</if>>

[[å¤§å…]]


:: èµ·å±…å®¤ {"position":"700,250","size":"100,100"}
=èµ·å±…å®¤=

ä¸€ä¸ªå°å°çš„æˆ¿é—´ï¼Œæ•´æ´ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æ²¡æœ‰ä»€ä¹ˆç”Ÿæ´»æ°”æ¯ã€‚ 
ä¸€å¼ åºŠï¼Œä¸€å¼ æ¤…å­ï¼Œæ¡Œå­ã€‚
æ¡Œå­ä¸Šé¢æ”¾ç€[[ä¸€æœ¬ç¿»å¼€çš„ä¹¦]]ï¼Œè¿˜æœ‰èœ¡çƒ›ç‡ƒå°½ç•™ä¸‹çš„çƒ›æ³ªã€‚

<<if not $beginnerWeaponGot>>
å¢™ä¸ŠæŒ‚ç€ä¸€æŸ„$beginnerWeapon['name']ã€‚\
<<button "è£…å¤‡" "èµ·å±…å®¤">>\
<<set $me.weapon to $beginnerWeapon>>\
<<set $beginnerWeaponGot to true>>\
<</button>>\
<<else>>\
å¢™ä¸Šæ”¾æ­¦å™¨çš„åœ°æ–¹ç©ºç©ºå¦‚ä¹Ÿã€‚\
<</if>>\

<<if not $beginnerArmorGot>>
å¢™ä¸ŠæŒ‚ç€ä¸€å¥—$beginnerArmor['name']ã€‚\
<<button "è£…å¤‡" "èµ·å±…å®¤">>\
<<set $me.armor to $beginnerArmor>>\
<<set $beginnerArmorGot to true>>\
<</button>>\
<<else>>\
å¢™ä¸Šæ”¾é˜²å…·çš„åœ°æ–¹ç©ºç©ºå¦‚ä¹Ÿã€‚\
<</if>>\


[[ä¼‘æ¯]]
åˆ°[[å¤§å…]]å»ã€‚


:: StoryScript [script]

window.fight = function fight(obj1, obj2) {
    // å®šä¹‰è®¡ç®—ä¼¤å®³çš„å‡½æ•°
    function calculateDamage(attacker, defender) {
        const damage = attacker.power - defender.resistance;
        return damage > 0 ? damage : 1; // ç¡®ä¿ä¼¤å®³ä¸ä¼šæ˜¯è´Ÿæ•°
    }

    // å›åˆåˆ¶æˆ˜æ–—
    while (obj1.hp > 0 && obj2.hp > 0) {
        // obj1 å…ˆæ”»å‡» obj2
      	let damage = calculateDamage(obj1, obj2);
        obj2.hp -= damage;
      	console.log(obj2.name + 'æ”¶åˆ°äº†' + damage + 'ç‚¹ä¼¤å®³ï¼');
        if (obj2.hp <= 0) {
            obj2.hp = 0;
            break; // obj2 å€’ä¸‹ï¼Œæˆ˜æ–—ç»“æŸ
        }

        // obj2 åå‡» obj1
      	damage = calculateDamage(obj2, obj1);
      	console.log(obj1.name + 'æ”¶åˆ°äº†' + damage + 'ç‚¹ä¼¤å®³ï¼');
      	obj1.hp -= damage;
        if (obj1.hp <= 0) {
            obj1.hp = 0;
            break; // obj1 å€’ä¸‹ï¼Œæˆ˜æ–—ç»“æŸ
        }
    }
    return {obj1, obj2};
}

window.dropItems = function dropItems(drops) {
    let itemList = [];

    // éå†dropsæ•°ç»„
    drops.forEach(drop => {
        // ç”Ÿæˆä¸€ä¸ªéšæœºæ•° (0-1)
        let randomChance = Math.random();
      	console.log(randomChance)
      	console.log(drop.chance)
        
        // å¦‚æœéšæœºæ•°å°äºç­‰äºæ‰è½å‡ ç‡ï¼Œåˆ™æ‰è½ç‰©å“
        if (randomChance <= drop.chance) {
            itemList.push(drop.item);
        }
    });

    return itemList; // è¿”å›æ‰è½çš„ç‰©å“åˆ—è¡¨
}

window.dropString = function dropString(droppedItems) {
    // å¦‚æœdroppedItemsä¸ºç©ºï¼Œè¿”å›æç¤ºä¿¡æ¯
    if (droppedItems.length === 0) {
        return "æ²¡æœ‰ç‰©å“æ‰è½";
    }
    
    // æå–æ¯ä¸ªç‰©å“çš„åå­—ï¼Œå¹¶ç”¨é€—å·è¿æ¥æˆå­—ç¬¦ä¸²
    let itemNames = droppedItems.map(item => item.name);
    return itemNames.join(', ');
}

window.addToInventory = function(inventory, itemList) {
    itemList.forEach(item => {
        // æ£€æŸ¥ inventory ä¸­æ˜¯å¦å·²æœ‰è¯¥ç‰©å“
        let existingItem = inventory.find(inventoryItem => inventoryItem.name === item.name);
        
        if (existingItem) {
            // å¦‚æœå·²æœ‰è¯¥ç‰©å“ï¼Œå¢åŠ  count
            existingItem.count++;
        } else {
            // å¦‚æœæ²¡æœ‰ï¼Œæ–°å¢ç‰©å“å¹¶è®¾ç½® count ä¸º 1
            inventory.push({ ...item, count: 1 });
        }
    });
}

window.checkHavingItem = function(inventory, itemName) {
    // æŸ¥æ‰¾ inventory ä¸­çš„ç‰©å“
    let item = inventory.find(inventoryItem => inventoryItem.name === itemName);
    
    // å¦‚æœç‰©å“ä¸å­˜åœ¨ï¼Œæˆ–è€… count ä¸º 0ï¼Œè¿”å› falseï¼ˆä¸æŒæœ‰ï¼‰
    if (!item || item.count === 0) {
        return false;
    }
    
    // å¦åˆ™è¿”å› trueï¼ˆæŒæœ‰ï¼‰
    return true;
}

window.getItem = function getItem(inventory, itemName) {
    // æŸ¥æ‰¾ inventory ä¸­çš„ç‰©å“
    let item = inventory.find(inventoryItem => inventoryItem.name === itemName);
    
    // å¦‚æœç‰©å“å­˜åœ¨ï¼Œè¿”å›è¯¥ç‰©å“ï¼Œå¦åˆ™è¿”å› null
    return item || null;
}

window.reduceItemCount = function reduceItemCount(inventory, itemName, count) {
    // æŸ¥æ‰¾ inventory ä¸­çš„ç‰©å“
    let item = inventory.find(inventoryItem => inventoryItem.name === itemName);
    
    if (item) {
        // å‡å°‘ç‰©å“æ•°é‡
        item.count -= count;
        
        // å¦‚æœç‰©å“æ•°é‡å°äºç­‰äº 0ï¼Œå°† count è®¾ä¸º 0
        if (item.count <= 0) {
            item.count = 0;
        }
    } else {
        console.log(`ç‰©å“ ${itemName} ä¸å­˜åœ¨äº inventory ä¸­ã€‚`);
    }
}

window.addItem = function addItem(inventory, item, count = 1) {
    // æŸ¥æ‰¾æ˜¯å¦å·²æœ‰è¯¥ç‰©å“
    let existingItem = inventory.find(inventoryItem => inventoryItem.name === item.name);
    
    if (existingItem) {
        // å¦‚æœæŒæœ‰ï¼Œæ›´æ–°ç‰©å“çš„æ•°é‡å’Œæè¿°
        existingItem.count += count;
        existingItem.desc = item.desc;  // æ›´æ–°ç‰©å“çš„æè¿°
    } else {
        // å¦‚æœä¸æŒæœ‰ï¼Œæ–°å¢ç‰©å“å¹¶è®¾ç½® count
        inventory.push({ ...item, count: count });
    }
}

:: StoryStylesheet [stylesheet]
.danger{
	color: red;
}
.good{
	color: green;
}
.important{
  	color: orange;
}
.red{
	color: red;
}